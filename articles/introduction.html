<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to BHAM • BHAM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BHAM">
<meta property="og:description" content="BHAM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BHAM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/comparison_BhGLM.html">Comparison with BhGLM</a>
    </li>
    <li>
      <a href="../articles/covariate_model.html">Additive Model with Covariates</a>
    </li>
    <li>
      <a href="../articles/functional_selection.html">Functional Selection</a>
    </li>
    <li>
      <a href="../articles/group_argument.html">Understand `group` argument</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to BHAM</a>
    </li>
    <li>
      <a href="../articles/model_assessment.html">Empirical Model Diagnostic</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/boyiguo1/BHAM/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to BHAM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/boyiguo1/BHAM/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<div id="dependency" class="section level3">
<h3 class="hasAnchor">
<a href="#dependency" class="anchor"></a>Dependency</h3>
<p>We use the spline functions and ancillary functions from the package <code>mgcv</code> to create spline data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: nlme</span>
<span class="co">#&gt; This is mgcv 1.8-34. For overview type 'help("mgcv-package")'.</span></code></pre></div>
</div>
<div id="simulate-data" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-data" class="anchor"></a>Simulate data</h3>
<p>We write a function that follows the data generating equation from Bai (citation). The outcome distribution could come from one of Gaussian, Poisson, or Binomial distributions. Please see (function link) here. Note here, the data output from the the simulation function is “raw” data. In order to have the final design matrix for analysis, you need to set up the spline functions of your preference via a data frame (see example in ), and use the function <code>construct_smooth_data</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co">## simulate some data... </span>

<span class="va">n_train</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">n_test</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span>

<span class="co"># Train Data</span>
<span class="va">train_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_Bai.html">sim_Bai</a></span><span class="op">(</span><span class="va">n_train</span>, <span class="va">p</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">train_dat</span><span class="op">$</span><span class="va">dat</span> <span class="op">%&gt;%</span> <span class="va">data.frame</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">train_dat</span><span class="op">$</span><span class="va">theta</span>

<span class="co"># Test Data</span>
<span class="va">test_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_Bai.html">sim_Bai</a></span><span class="op">(</span><span class="va">n_test</span>, <span class="va">p</span><span class="op">)</span>
<span class="va">test_dat</span> <span class="op">&lt;-</span> <span class="va">test_tmp</span><span class="op">$</span><span class="va">dat</span> <span class="op">%&gt;%</span> <span class="va">data.frame</span>
<span class="va">test_theta</span> <span class="op">&lt;-</span> <span class="va">test_tmp</span><span class="op">$</span><span class="va">theta</span></code></pre></div>
</div>
<div id="make-design-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#make-design-matrix" class="anchor"></a>Make Design Matrix</h3>
<div id="set-up-spline-function" class="section level4">
<h4 class="hasAnchor">
<a href="#set-up-spline-function" class="anchor"></a>Set up Spline function</h4>
<p>Since our models are primarily designed for high-dimensional applications. Hence, we are mindful about how to formulate the regression equation. Our solution here is to use a data frame which contains the necessary components of a spline function, in the format of <code>Var</code> <code>Func</code>, <code>Args</code>, which later passed to a parser function, which will assemble the regression equation for you. We believe such automation process, implemented in <code>construct_smooth_data</code>, will ease the task load to set up the regression formula, when the number of spline components grows to tens or hundreds.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Low-dimensional setting</span>
<span class="va">mgcv_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">Var</span>, <span class="op">~</span><span class="va">Func</span>, <span class="op">~</span><span class="va">Args</span>,
    <span class="st">"X1"</span>,  <span class="st">"s"</span>,     <span class="st">"bs='cr', k=5"</span>,
    <span class="st">"X2"</span>,  <span class="st">"s"</span>,     <span class="cn">NA</span>,
    <span class="st">"X3"</span>,  <span class="st">"s"</span>,    <span class="st">""</span>,
  <span class="op">)</span>

<span class="co"># High-dimensional setting</span>
<span class="va">mgcv_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  Var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="st">"y"</span><span class="op">)</span>,
  Func <span class="op">=</span> <span class="st">"s"</span>,
  Args <span class="op">=</span><span class="st">"bs='cr', k=7"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="make-design-matrix-1" class="section level4">
<h4 class="hasAnchor">
<a href="#make-design-matrix-1" class="anchor"></a>Make Design Matrix</h4>
<p>We use <code>smoothCon</code> from the package <code>mgcv</code> to construct the . Hence, our <code>construct_smooth_data</code> have the potential to work with user-defined spline functions as long as it follows <code>mgcv</code> standard.</p>
<p>In our <code>construct_smooth_data</code>, we have taken multiple reparameterization steps via <code>smoothCon</code>: 1) linear constraints, 2) eigen decomposition of the smoothing matrix <span class="math inline">\(S\)</span> to isolate null and penalized spaces, 3) scaling of the design matrix to have unit variance for each column of the data set, i.e. bases of the design matrix.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_sm_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_smooth_data.html">construct_smooth_data</a></span><span class="op">(</span><span class="va">mgcv_df</span>, <span class="va">dat</span><span class="op">)</span>
<span class="va">train_smooth_data</span> <span class="op">&lt;-</span> <span class="va">train_sm_dat</span><span class="op">$</span><span class="va">data</span></code></pre></div>
</div>
<div id="make-prediction-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#make-prediction-matrix" class="anchor"></a>Make Prediction Matrix</h4>
<p>Due to the reparameterization in the design matrix, it creates complication with setting up the design matrix for the test data. Hence, we write an wrapping function for <code>PredictMat</code> from <code>mgcv</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_smooth</span> <span class="op">&lt;-</span> <span class="va">train_sm_dat</span><span class="op">$</span><span class="va">Smooth</span>
<span class="va">test_sm_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_predict_dat.html">make_predict_dat</a></span><span class="op">(</span><span class="va">train_sm_dat</span><span class="op">$</span><span class="va">Smooth</span>, dat <span class="op">=</span> <span class="va">test_dat</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="fitting-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-the-model" class="anchor"></a>Fitting the model</h2>
<p>The model fitting function is similar to</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># </span>
<span class="co"># lasso_mdl &lt;- cv.glmnet(train_smooth_data %&gt;% as.matrix, dat$y, family = "binomial")</span>
<span class="co"># lasso_mdl &lt;- glmnet(train_smooth_data %&gt;% as.matrix, dat$y, family = "binomial", lambda=lasso_mdl$lambda.min)</span>

<span class="co"># mdl1 &lt;- bglm_spline(y~.-y,</span>
<span class="co">#          data = data.frame(train_smooth_data, y = dat$y), family = "binomial", prior = mt(df=Inf), group = make_group(names(train_smooth_data)))</span>

<span class="co"># mdl1_margin &lt;- bglm(y~.-y,</span>
<span class="co">#          data = data.frame(train_smooth_data, y = dat$y), family = "binomial", prior = mt(df=Inf), group = make_group(names(train_smooth_data)))</span>
<span class="co"># </span>
<span class="co"># mdl1_scale &lt;- bglm_spline(y~.-y,</span>
<span class="co">#          data = data.frame(scale(train_smooth_data), y = dat$y), family = "binomial", prior = mt(df=Inf), group = make_group(names(train_smooth_data)))</span>
<span class="co"># </span>




<span class="co"># mdl1 &lt;- bglm_spline(y~.-y,</span>
 <span class="va">mdl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bgam.html">bgam</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span><span class="op">-</span><span class="va">y</span>,
         data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">train_smooth_data</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="fu">mde</span><span class="op">(</span><span class="op">)</span>, group <span class="op">=</span> <span class="fu"><a href="../reference/make_group.html">make_group</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>


<span class="va">mdl1_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bgam.html">bgam</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span><span class="op">-</span><span class="va">y</span>,
         data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span>  <span class="fu">mde</span><span class="op">(</span><span class="op">)</span>, group <span class="op">=</span> <span class="fu"><a href="../reference/make_group.html">make_group</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>



<span class="va">mdl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bgam.html">bgam</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span><span class="op">-</span><span class="va">y</span>,
         data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">train_smooth_data</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, prior <span class="op">=</span> <span class="fu">mt</span><span class="op">(</span>df<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>, group <span class="op">=</span> <span class="fu"><a href="../reference/make_group.html">make_group</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span>, penalize_null <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>


<span class="va">mdl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlasso.html">bamlasso</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train_smooth_data</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, group <span class="op">=</span> <span class="fu"><a href="../reference/make_group.html">make_group</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="tuning-via-cross-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#tuning-via-cross-validation" class="anchor"></a>Tuning via Cross-validation</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s0_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<div id="bgam" class="section level3">
<h3 class="hasAnchor">
<a href="#bgam" class="anchor"></a>bgam</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.bgam.html">cv.bgam</a></span><span class="op">(</span><span class="va">mdl1</span><span class="op">)</span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.02 minutes</span>
<span class="co"># Validation</span>
<span class="co"># set.seed(1)</span>
<span class="co"># tmp2 &lt;- cv.bh(mdl1)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tune.bgam.html">tune.bgam</a></span><span class="op">(</span><span class="va">mdl1</span>, s0 <span class="op">=</span> <span class="va">s0_seq</span><span class="op">)</span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.016 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.015 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.014 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.019 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.02 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.023 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.018 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.019 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.015 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.014 minutes</span>


<span class="co"># res &lt;- map_dfr(s0_seq, .f = function(.s0, .mdl){</span>
<span class="co">#  set.seed(1)</span>
<span class="co">#  tmp &lt;- cv.bgam(.mdl, s0 = .s0) </span>
<span class="co">#  tmp$measures %&gt;% t() %&gt;% data.frame </span>
<span class="co"># },</span>
<span class="co"># .mdl = mdl1) %&gt;% </span>
<span class="co">#   data.frame(s0 = s0_seq,.)</span></code></pre></div>
</div>
<div id="bamlasso" class="section level3">
<h3 class="hasAnchor">
<a href="#bamlasso" class="anchor"></a>bamlasso</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.bgam.html">cv.bgam</a></span><span class="op">(</span><span class="va">mdl2</span><span class="op">)</span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.009 minutes</span>
<span class="co"># set.seed(1)</span>
<span class="co"># tmp2 &lt;- cv.bh(mdl2)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tune.bgam.html">tune.bgam</a></span><span class="op">(</span><span class="va">mdl2</span>, s0 <span class="op">=</span> <span class="va">s0_seq</span><span class="op">)</span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.008 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.01 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.009 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.009 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.008 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.01 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.01 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.01 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.009 minutes </span>
<span class="co">#&gt; Fitting ncv*nfolds = 10 models: </span>
<span class="co">#&gt; 1 2 3 4 5 6 7 8 9 10 </span>
<span class="co">#&gt;  Cross-validation time: 0.009 minutes</span></code></pre></div>
</div>
</div>
<div id="cross-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-validation" class="anchor"></a>Cross-validation</h2>
<p>Many of the functionalities in the R package <code>BhGLM</code> can be directly applied to the <code>bgam</code> and <code>bamlasso</code> models, for example cross validations</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BhGLM"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"boyiguo1/BhGLM@spline"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BhGLM</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pROC"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pROC"</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/pkg/BhGLM/man/cv.bh.html">cv.bh</a></span><span class="op">(</span><span class="va">mdl1</span><span class="op">)</span></code></pre></div>
</div>
<div id="model-results-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#model-results-summary" class="anchor"></a>Model Results Summary</h2>
<div id="functional-selection" class="section level3">
<h3 class="hasAnchor">
<a href="#functional-selection" class="anchor"></a>Functional Selection</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BhGLM/man/df.adj.html">df.adj</a></span><span class="op">(</span><span class="va">mdl1</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"x2[.]pen"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BhGLM/man/df.adj.html">df.adj</a></span><span class="op">(</span><span class="va">mdl1</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"x20[.]pen"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="fu">calculate_EDF</span><span class="op">(</span><span class="va">mdl1</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"x2[.]pen"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="fu">calculate_EDF</span><span class="op">(</span><span class="va">mdl1</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"x20[.]pen"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>


<span class="fu">calculate_EDF</span><span class="op">(</span><span class="va">mdl1</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"x1[.]null"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_smooth_data</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Boyi Guo, Nengjun Yi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
